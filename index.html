<!DOCTYPE html>
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
            background-image: url("https://cdnb.artstation.com/p/assets/images/images/011/445/369/large/remi-delmotte-hueco-mundo.jpg?1529609712&dl=1");
            background-size: cover; background-position: center; font-family: 'Courier New', monospace;
        }

        /* 1. HOME MENU */
        #home-menu {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; text-align: center;
        }

        /* 2. LOADING SCREEN (Hidden initially) */
        #loading-screen {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 150; flex-direction: column; align-items: center; justify-content: center;
            color: #60a5fa;
        }
        #load-bar-bg { width: 300px; height: 10px; background: #333; border: 2px solid white; margin-top: 20px; border-radius: 5px; overflow: hidden; }
        #load-bar-fill { width: 0%; height: 100%; background: #60a5fa; transition: 0.1s; }

        .menu-btn {
            background: #1d4ed8; color: white; border: 3px solid white;
            padding: 15px 50px; margin: 10px; font-size: 24px; cursor: pointer;
            width: 320px; transition: 0.3s; border-radius: 10px;
        }

        /* 3. GAME AREA */
        #game-area { display: none; width: 100%; height: 100%; position: relative; }
        #hud { position: absolute; top: 10px; left: 20px; color: #facc15; font-size: 24px; font-weight: bold; z-index: 10; text-shadow: 2px 2px #000; }
        
        /* SPRITES */
        #sonic {
            position: absolute; top: 350px; left: 100px; width: 140px; height: 140px;
            background: url(https://docs.google.com/drawings/d/e/2PACX-1vSU2kymmebcoyonKiAeVWtczSiq12r7yeOqHpCD1P40lBrVvg-8P1cCEvyPFQMyNMn5G2g4cHHJT0Gz/pub?w=960&h=720);
            background-size: 960px 720px; z-index: 5; background-position: left 0in top -1in;
        }
        .state-roll { background-position: left -1in top 0in !important; animation: fastSpin 0.15s infinite linear; }
        @keyframes fastSpin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        #ring { position: absolute; width: 60px; height: 60px; background: url(https://docs.google.com/drawings/d/e/2PACX-1vSU2kymmebcoyonKiAeVWtczSiq12r7yeOqHpCD1P40lBrVvg-8P1cCEvyPFQMyNMn5G2g4cHHJT0Gz/pub?w=960&h=720) left -1in top 0in; }
    </style>
</head>
<body>

    <div id="home-menu">
        <h1 style="font-size: 50px; margin-bottom: 40px;">KOSHISH RUNNER</h1>
        <button class="menu-btn" onclick="startLoading()">PLAY GAME</button>
        <button class="menu-btn" onclick="alert('High Score: ' + (localStorage.getItem('sonicHS') || 0))">HIGH SCORE</button>
    </div>

    <div id="loading-screen">
        <h2 id="load-text">LOADING LEVEL...</h2>
        <div id="load-bar-bg"><div id="load-bar-fill"></div></div>
    </div>

    <div id="game-area">
        <div id="hud">RINGS: <span id="ring-count">0</span></div>
        <div id="sonic"></div>
        <div id="ring"></div>
    </div>

    <script>
        var rings = 0;
        var ringAudio = new Audio('https://docs.google.com/uc?export=download&id=1ETKypIjRUWk4m4rle2X9nihfnzY7Ur4C');

        function startLoading() {
            $("#home-menu").hide();
            $("#loading-screen").css("display", "flex");
            
            let progress = 0;
            let interval = setInterval(() => {
                progress += Math.floor(Math.random() * 10) + 2;
                $("#load-bar-fill").css("width", progress + "%");
                
                if (progress >= 100) {
                    clearInterval(interval);
                    $("#load-bar-fill").css("width", "100%");
                    setTimeout(initGame, 500);
                }
            }, 100);
        }

        function initGame() {
            $("#loading-screen").fadeOut();
            $("#game-area").fadeIn();
            spawnRing();
        }

        function collectRing() {
            rings++;
            ringAudio.pause(); ringAudio.currentTime = 0; ringAudio.play();
            $("#ring-count").text(rings);
            
            // Save High Score
            let hs = localStorage.getItem('sonicHS') || 0;
            if (rings > hs) localStorage.setItem('sonicHS', rings);
        }

        // MOVEMENT
        $(window).keydown(function(e) {
            let sPos = $("#sonic").position();
            if (e.key == "ArrowRight") $("#sonic").css({"left": sPos.left + 40, "transform": "scaleX(1)"});
            if (e.key == "ArrowLeft") $("#sonic").css({"left": sPos.left - 40, "transform": "scaleX(-1)"});
        });

        function spawnRing() {
            let rx = Math.random() * (window.innerWidth - 100);
            $("#ring").css({"top": "-50px", "left": rx}).show();
            $("#ring").animate({ top: "450px" }, 2000, "linear", function() {
                let sPos = $("#sonic").position();
                let rPos = $("#ring").position();
                if (Math.abs(sPos.left - rPos.left) < 80) collectRing();
                spawnRing();
            });
        }
    </script>
</body>
</html>
